# Google Password Checkup 实验说明

## 1. 实验目的

* 理解 Google Password Checkup 协议原理
* 掌握密码泄露检测的隐私保护方法
* 基于 PoC 实现协议流程验证
* 探索批量查询和 k-匿名分桶处理在实际应用中的效果
* 可视化展示泄露检测结果，直观理解协议效果

---

## 2. 实验原理

Google Password Checkup 协议旨在在不泄露用户明文密码的前提下，检测用户密码是否出现在已知泄露密码库中。

**核心流程（参考论文 Section 3.1 / Figure 2）**：

### 用户端

1. 将明文密码哈希，生成标识符
2. 对哈希值进行 k-匿名分桶处理，仅发送前 n 位
3. 支持批量提交多条密码

### 服务器端

1. 存储泄露密码库哈希
2. 接收用户请求，根据分桶标识匹配哈希
3. 返回每条密码是否泄露

### 返回结果

* 用户获知密码安全状态
* 服务器不获知明文密码，保证隐私

**协议特点**：

* 使用 SHA-256 哈希
* 采用 k-匿名分桶保护用户隐私
* 支持批量查询，提高效率
* 可通过可视化展示检测结果，提高分析直观性

---

## 3. 基础实验

**实验步骤与预期结果**：

### 步骤 1：准备泄露密码数据库

* 构建模拟泄露密码库，包含已知泄露密码集合
* 将密码进行 SHA-256 哈希存储（服务器端不保存明文）
* 可扩展为数百或数千条密码，模拟真实泄露场景

### 步骤 2：用户端密码处理

* 用户输入待检测密码
* 对密码进行 SHA-256 哈希
* 可单条处理，生成密码标识符

### 步骤 3：服务器端匹配

* 接收用户哈希
* 在泄露密码数据库中进行比对
* 返回匹配结果给用户

### 步骤 4：用户端结果反馈

* 若匹配 → 提示“密码已泄露，建议更改”
* 若未匹配 → 提示“密码安全”

### 步骤 5：基础实验分析

**预期实验结果**：

| 测试密码        | 哈希值（SHA-256）  | 泄露状态 | 用户端提示      |
| ----------- | ------------- | ---- | ---------- |
| password123 | ef92b778ba... | 未泄露  | 密码安全       |
| 123456      | 8d969eef6e... | 已泄露  | 密码已泄露，建议更改 |
| qwerty      | d8578edf84... | 已泄露  | 密码已泄露，建议更改 |
| mysecurepwd | 5e884898da... | 未泄露  | 密码安全       |

**分析与说明**：

* 用户端仅发送哈希值，服务器无法获知明文密码，验证了隐私保护机制
* 单条匹配功能正确，能够区分泄露和安全密码
* 哈希比对能够在不泄露密码的前提下完成检测，说明协议的安全性与可行性

---

## 4. 扩展实验

**实验步骤与预期结果**：

### 步骤 1：准备泄露密码数据库及分桶索引

* 构建模拟泄露密码库
* 对密码进行 SHA-256 哈希
* 按哈希前 n 位构建分桶索引，模拟 k-匿名处理

### 步骤 2：用户端批量密码处理

* 用户输入多条密码
* 批量生成哈希和分桶标识
* 可调整分桶大小，观察隐私保护与匹配精度变化

### 步骤 3：服务器端批量匹配

* 接收用户分桶标识列表
* 根据分桶索引查找对应泄露密码
* 判断每条密码是否泄露
* 支持批量查询，提高效率

**批量密码检测示例**：

| 密码          | 哈希值前 n 位 | 分桶标识 | 泄露状态 | 用户端提示      |
| ----------- | -------- | ---- | ---- | ---------- |
| password123 | ef92b7   | 桶1   | 未泄露  | 密码安全       |
| 123456      | 8d969e   | 桶5   | 已泄露  | 密码已泄露，建议更改 |
| qwerty      | d8578e   | 桶3   | 已泄露  | 密码已泄露，建议更改 |
| mysecurepwd | 5e8848   | 桶2   | 未泄露  | 密码安全       |

### 步骤 4：用户端结果反馈与可视化

* 返回每条密码的泄露状态

**可视化示例**：

* 饼图显示泄露/安全密码比例：泄露密码 50%，安全密码 50%
* 条形图显示每条密码状态：

```
密码123456  ██████████ 已泄露
密码qwerty  ██████████ 已泄露
密码password123 ████      安全
密码mysecurepwd ████      安全
```

### 步骤 5：扩展实验分析

* 比较基础实验与扩展实验在效率和隐私保护上的差异
* 分析批量查询与单条查询性能差异
* 探索协议改进方案：分桶随机化、频率平滑、加密哈希处理
* 总结 Google Password Checkup 协议在安全性、隐私保护和查询效率之间的权衡

---

## 5. 实验总结

1. 基础实验验证了 Google Password Checkup 的核心流程
2. 扩展实验展示了 k-匿名分桶和批量查询的效果
3. 可视化分析直观展示密码泄露情况
4. 实验结果显示协议在保护用户隐私与检测泄露密码之间达成平衡
5. 协议可扩展至真实泄露数据库环境，同时保持安全性和隐私保护
